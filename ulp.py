import sublime, sublime_plugin, json

class UlpCommand(sublime_plugin.EventListener):

	def __init__(self):
		with open(sublime.packages_path() + '/ulpsnt/functions.json', encoding='utf-8') as data_file:    
			self.data = json.load(data_file)
		#self.liste = [('', 'Beschreibung für int2str'),('real2str', 'Beschreibung für real2str'),( 'str2int', 'Beschreibung'),( 'debug', 'Beschreibung'),( 'changeChar', 'Beschreibung'),( 'cutsubstring', 'Beschreibung'),( 'trimws', 'Beschreibung'),( 'log2', 'Beschreibung'),( 'cmpstr', 'Beschreibung'),( 'strrep', 'Beschreibung'),( 'rexfromstr', 'Beschreibung'),( 'fuzzysearchrex', 'Beschreibung'),( 'dlgStrEd', 'Beschreibung'),( 'errormsg', 'Beschreibung'),( 'cuthtmltags', 'Beschreibung'),( 'exhtmlchars', 'Beschreibung'),( 'abs', 'Beschreibung'),( 'acos', 'Beschreibung'),( 'asin', 'Beschreibung'),( 'atan', 'Beschreibung'),( 'ceil', 'Beschreibung'),( 'cfgget', 'Beschreibung'),( 'cfgset', 'Beschreibung'),( 'clrgroup', 'Beschreibung'),( 'country', 'Beschreibung'),( 'cos', 'Beschreibung'),( 'exit', 'Beschreibung'),( 'exp', 'Beschreibung'),( 'fdlsignature', 'Beschreibung'),( 'filedir', 'Beschreibung'),( 'fileerror', 'Beschreibung'),( 'fileext', 'Beschreibung'),( 'fileglob', 'Beschreibung'),( 'filename', 'Beschreibung'),( 'fileread', 'Beschreibung'),( 'filesetext', 'Beschreibung'),( 'filesize', 'Beschreibung'),( 'filetime', 'Beschreibung'),( 'floor', 'Beschreibung'),( 'frac', 'Beschreibung'),( 'inch2u', 'Beschreibung'),( 'ingroup', 'Beschreibung'),( 'isalnum', 'Beschreibung'),( 'isalpha', 'Beschreibung'),( 'iscntrl', 'Beschreibung'),( 'isdigit', 'Beschreibung'),( 'isgraph', 'Beschreibung'),( 'islower', 'Beschreibung'),( 'isprint', 'Beschreibung'),( 'ispunct', 'Beschreibung'),( 'isspace', 'Beschreibung'),( 'isupper', 'Beschreibung'),( 'isxdigit', 'Beschreibung'),( 'language', 'Beschreibung'),( 'log', 'Beschreibung'),( 'log10', 'Beschreibung'),( 'lookup', 'Beschreibung'),( 'max', 'Beschreibung'),( 'mic2u', 'Beschreibung'),( 'mil2u', 'Beschreibung'),( 'min', 'Beschreibung'),( 'mm2u', 'Beschreibung'),( 'neterror', 'Beschreibung'),( 'netget', 'Beschreibung'),( 'netpost', 'Beschreibung'),( 'palette', 'Beschreibung'),( 'pow', 'Beschreibung'),( 'printf', 'Beschreibung'),( 'round', 'Beschreibung'),( 'setgroup', 'Beschreibung'),( 'setvariant', 'Beschreibung'),( 'sin', 'Beschreibung'),( 'sort', 'Beschreibung'),( 'sprintf', 'Beschreibung'),( 'sqrt', 'Beschreibung'),( 'status', 'Beschreibung'),( 'strchr', 'Beschreibung'),( 'strjoin', 'Beschreibung'),( 'strlen', 'Beschreibung'),( 'strlwr', 'Beschreibung'),( 'strrchr', 'Beschreibung'),( 'strrstr', 'Beschreibung'),( 'strsplit', 'Beschreibung'),( 'strstr', 'Beschreibung'),( 'strsub', 'Beschreibung'),( 'strtod', 'Beschreibung'),( 'strtol', 'Beschreibung'),( 'strupr', 'Beschreibung'),( 'strxstr', 'Beschreibung'),( 'system', 'Beschreibung'),( 't2day', 'Beschreibung'),( 't2dayofweek', 'Beschreibung'),( 't2hour', 'Beschreibung'),( 't2minute', 'Beschreibung'),( 't2month', 'Beschreibung'),( 't2second', 'Beschreibung'),( 't2string', 'Beschreibung'),( 't2year', 'Beschreibung'),( 'tan', 'Beschreibung'),( 'time', 'Beschreibung'),( 'tolower', 'Beschreibung'),( 'toupper', 'Beschreibung'),( 'trunc', 'Beschreibung'),( 'u2inch', 'Beschreibung'),( 'u2mic', 'Beschreibung'),( 'u2mil', 'Beschreibung'),( 'u2mm', 'Beschreibung'),( 'variant', 'Beschreibung'),( 'xmlattribute', 'Beschreibung'),( 'xmlattributes', 'Beschreibung'),( 'xmlelement', 'Beschreibung'),( 'xmlelements', 'Beschreibung'),( 'xmltags', 'Beschreibung'),( 'xmltext', 'Beschreibung'),( 'dlgCell', 'Beschreibung'),( 'dlgCheckBox', 'Beschreibung'),( 'dlgComboBox', 'Beschreibung'),( 'dlgDialog', 'Beschreibung'),( 'dlgGridLayout', 'Beschreibung'),( 'dlgGroup', 'Beschreibung'),( 'dlgHBoxLayout', 'Beschreibung'),( 'dlgIntEdit', 'Beschreibung'),( 'dlgLabel', 'Beschreibung'),( 'dlgListBox', 'Beschreibung'),( 'dlgListView', 'Beschreibung'),( 'dlgPushButton', 'Beschreibung'),( 'dlgRadioButton', 'Beschreibung'),( 'dlgRealEdit', 'Beschreibung'),( 'dlgSpacing', 'Beschreibung'),( 'dlgSpinBox', 'Beschreibung'),( 'dlgStretch', 'Beschreibung'),( 'dlgStringEdit', 'Beschreibung'),( 'dlgTabPage', 'Beschreibung'),( 'dlgTabWidget', 'Beschreibung'),( 'dlgTextEdit', 'Beschreibung'),( 'dlgTextView', 'Beschreibung'),( 'dlgVBoxLayout', 'Beschreibung')]
		#frac
		#dlgTextEdit
	def on_selection_modified(self,view):
		word = view.substr(view.word(view.sel()[0]))
		#for j,k in self.liste:
			#if word == j:
		#if self.data[word] != "" :
		if word in self.data:
			self.data[word]
			view.show_popup('<html> <body>' + self.data[word]["variants"][0]["returntype"] + '<b> ' +
					self.data[word]["variants"][0]["syntax"] + '</b><br>' + 
					self.data[word]["variants"][0]["returns"] + '<br>' + 
					self.data[word]["variants"][0]["description"] + '</body> </html>', max_width=1000)
		
				#view.show_popup('Hello, <b>'+ k +'!</b><br><a href="moo">Click Me</a>', on_navigate=print)